<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Web Packaging</title>
<meta content="Jeffrey Yasskin" name="author">
<meta content="
       Web Packages provide a way to bundle up groups of web resources to
transmit them together. These bundles can be signed to establish their
authenticity. 
    " name="description">
<meta content="xml2rfc 2.40.1" name="generator">
<meta content="draft-yasskin-dispatch-web-packaging-latest" name="ietf.draft">
<link href="draft-yasskin-dispatch-web-packaging.xml" type="application/rfc+xml" rel="alternate">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 624px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  line-height: 17px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
  table {
    display: inline-block;
    overflow-x: auto;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #eee;
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  font-style: italic;
  margin: 0.3em 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 600px) {
  #authors-addresses > section {
    display: relative;
    padding: 32px 0 0;
    column-count: 2;
    column-gap: 20px;
  }
  #name-authors-addresses {
    position: absolute;
    top: 0px;
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #b76427;
  background-color: rgba(249, 232, 105, 0.3);
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: rgba(249, 232, 105, 0.3);
  border-radius: 3px;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 953px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 954px) {
  body {
    padding-right: 380px;
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>
<link href="rfc-local.css" type="text/css" rel="stylesheet">
</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Web Packaging</td>
<td class="right">March 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Yasskin</td>
<td class="center">Expires 13 September 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-yasskin-dispatch-web-packaging-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-03-12" class="published">12 March 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-09-13">13 September 2020</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Yasskin</div>
<div class="org">Google</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Web Packaging</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Web Packages provide a way to bundle up groups of web resources to
transmit them together. These bundles can be signed to establish their
authenticity.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 13 September 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-use-cases" class="xref">Use Cases</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-why-not-zip" class="xref">Why not ZIP?</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-the-need-for-standardizatio" class="xref">The Need for Standardization</a><a href="#section-toc.1-1.1.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-format" class="xref">Format</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-mode-of-specification" class="xref">Mode of specification</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-top-level-structure" class="xref">Top-level structure</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="xref">2.2.1</a>.  <a href="#name-from-the-end" class="xref">From the end</a><a href="#section-toc.1-1.2.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="xref">2.2.2</a>.  <a href="#name-from-the-beginning" class="xref">From the beginning</a><a href="#section-toc.1-1.2.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-parsing-the-index" class="xref">Parsing the index</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-parsing-the-manifest" class="xref">Parsing the manifest</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.4.2.1">
                    <p id="section-toc.1-1.2.2.4.2.1.1"><a href="#section-2.4.1" class="xref">2.4.1</a>.  <a href="#name-sub-packages" class="xref">Sub-packages</a><a href="#section-toc.1-1.2.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-parsing-a-resource" class="xref">Parsing a resource</a><a href="#section-toc.1-1.2.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-guidelines-for-package-auth" class="xref">Guidelines for package authors</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-internet-media-type-registr" class="xref">Internet Media Type Registration</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="problems">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">People would like to use content offline and in other situations where
there isn't a direct connection to the server where the content
originates. However, it's difficult to distribute and verify the
authenticity of applications and content without a connection to the
network. The W3C has addressed running applications offline with
Service Workers (<span>[<a href="#ServiceWorkers" class="xref">ServiceWorkers</a>]</span>), but not
the problem of distribution.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">We've started work on this problem
in <span><a href="https://github.com/WICG/webpackage">https://github.com/WICG/webpackage</a></span>, but we suspect that the
IETF may be the right place to standardize the overall format. More
details can be found in that repository.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="use-cases">
<section id="section-1.1">
        <h3 id="name-use-cases">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
        </h3>
<p id="section-1.1-1">See <span>[<a href="#I-D.yasskin-wpack-use-cases" class="xref">I-D.yasskin-wpack-use-cases</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="not-zip">
<section id="section-1.2">
        <h3 id="name-why-not-zip">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-why-not-zip" class="section-name selfRef">Why not ZIP?</a>
        </h3>
<p id="section-1.2-1"><a href="https://github.com/WICG/webpackage/issues/45">WICG/webpackage#45</a><a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="need">
<section id="section-1.3">
        <h3 id="name-the-need-for-standardizatio">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-the-need-for-standardizatio" class="section-name selfRef">The Need for Standardization</a>
        </h3>
<p id="section-1.3-1">Publishers and readers should be able to generate a package once, and have it
usable by all browsers.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Terminology">
<section id="section-1.4">
        <h3 id="name-terminology">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.4-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="format">
<section id="section-2">
      <h2 id="name-format">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-format" class="section-name selfRef">Format</a>
      </h2>
<div id="mode">
<section id="section-2.1">
        <h3 id="name-mode-of-specification">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-mode-of-specification" class="section-name selfRef">Mode of specification</a>
        </h3>
<p id="section-2.1-1">This specification defines how conformant web package parsers convert a sequence
of bytes into the semantics of a web package. It does not constrain how web
package encoders produce such a package: although there are some guidelines in
<a href="#authoring-guidelines" class="xref">Section 3</a>, encoders MAY produce any sequence of bytes that a
conformant parser would parse into the intended semantics.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">In places, this specification says the parser "MAY return" some data. This
indicates that the described data is complete enough that later parsing failures
do not need to discard it.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">In places, this specification says the parser "MUST fail". The parser MAY report
these failures to its caller in any way, but MUST NOT return any data it has
parsed so far that wasn't mentioned in a "MAY return" statement.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">This specification creates local variables with the phrase "Let <em>variable-name</em>
be ...". Use of a variable before it's created is a defect in this
specification.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="top-level">
<section id="section-2.2">
        <h3 id="name-top-level-structure">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-top-level-structure" class="section-name selfRef">Top-level structure</a>
        </h3>
<p id="section-2.2-1">The package is roughly a CBOR item with the following CDDL schema, but package
parsers are required to successfully parse some byte strings that aren't valid
CBOR. For example, sections may have padding between them, or even overlap, as
long as the embedded relative offsets cause the parsing algorithm in this
specification to return data.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cddl" id="section-2.2-2">
<pre>
webpackage = [
  ; 🌐📦 in UTF-8.
  magic1: h'F0 9F 8C 90 F0 9F 93 A6',
  section-offsets: { * (($section-name .within tstr) =&gt; uint) },
  sections: [ *$section ],
  length: uint,  ; Total number of bytes in the package.
  ; 🌐📦 in UTF-8.
  magic2: h'F0 9F 8C 90 F0 9F 93 A6',
]

$section-name /= "indexed-content" / "manifest"

$section /= indexed-content / signed-manifest

indexed-content = [index, [*response]]
</pre><a href="#section-2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-2.2-3">The parser MAY begin parsing at either the <span><a href="#from-start" class="xref">beginning</a> (<a href="#from-start" class="xref">Section 2.2.2</a>)</span>
or <span><a href="#from-end" class="xref">end</a> (<a href="#from-end" class="xref">Section 2.2.1</a>)</span> of the byte string representing the package. Parsing from
the end is useful when the package is embedded in another format such as a
self-extracting executable, while parsing from the beginning is useful when
loading from a stream.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<div id="from-end">
<section id="section-2.2.1">
          <h4 id="name-from-the-end">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-from-the-end" class="section-name selfRef">From the end</a>
          </h4>
<p id="section-2.2.1-1">To parse from the end, the parser MUST load the last 18 bytes as the following
<span>[<a href="#CDDL" class="xref">CDDL</a>]</span> group in array context: 
  <span class="cref" id="ednote-loading-cddl">CDDL doesn't actually define how to use it as a schema
to load CBOR data.<span class="crefSource">jyasskin</span></span><a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cddl" id="section-2.2.1-2">
<pre>
tail = (
  ; Total number of bytes in the package.
  length: uint,
  ; 🌐📦 in UTF-8.
  magic2: h'F0 9F 8C 90 F0 9F 93 A6',
)
</pre><a href="#section-2.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.2.1-3">If the bytes don't match this group or these two CBOR items don't occupy exactly
18 bytes, parsing MUST fail.<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.2.1-4">Otherwise, continue as if the byte <code>length</code> bytes before the end of the string
were the beginning of the package, and the parser were
a <span><a href="#from-start" class="xref">from the beginning</a> (<a href="#from-start" class="xref">Section 2.2.2</a>)</span> parser.<a href="#section-2.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="from-start">
<section id="section-2.2.2">
          <h4 id="name-from-the-beginning">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-from-the-beginning" class="section-name selfRef">From the beginning</a>
          </h4>
<p id="section-2.2.2-1">If the first 10 bytes of the package are not "85 48 F0 9F 8C 90 F0 9F 93 A6"
(the CBOR encoding of the 5-item array header and 8-byte bytestring header,
followed by &amp;#127760;&amp;#128230; in UTF-8), parsing MUST fail.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2">Parse one CBOR item starting at the 11th byte of the package. If this does not
match the CDDL<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cddl" id="section-2.2.2-3">
<pre>
section-offsets = { * tstr =&gt; uint },
</pre><a href="#section-2.2.2-3" class="pilcrow">¶</a>
</div>
<p id="section-2.2.2-4">or it is not a Canonical CBOR item (Section 3.9 of <span>[<a href="#CBOR" class="xref">CBOR</a>]</span>), parsing MUST fail.<a href="#section-2.2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2.2-5">Let <em>sections-start</em> be the offset of the byte after the <code>section-offsets</code> item.
For example, if <code>section-offsets</code> were 52 bytes long, <em>sections-start</em> would be
63.<a href="#section-2.2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2.2-6">This specification defines two section names: "indexed-content" and "manifest".<a href="#section-2.2.2-6" class="pilcrow">¶</a></p>
<p id="section-2.2.2-7">If <code>section-offsets</code>["indexed-content"] is not present, parsing MUST fail.<a href="#section-2.2.2-7" class="pilcrow">¶</a></p>
<p id="section-2.2.2-8">The parser MUST ignore unknown keys in the <code>section-offsets</code> map because new
sections may be defined in future specifications.

  <span class="cref" id="ednote-critical-sections">Do we need to mark critical section names?<span class="crefSource">jyasskin</span></span><a href="#section-2.2.2-8" class="pilcrow">¶</a></p>
<p id="section-2.2.2-9">Let <em>index</em> be the result of parsing the bytes starting at offset
<em>sections-start</em> + <code>section-offsets</code>["indexed-content"] using the instructions in
<a href="#index" class="xref">Section 2.3</a>.<a href="#section-2.2.2-9" class="pilcrow">¶</a></p>
<p id="section-2.2.2-10">If <code>section-offsets</code>["manifest"] is present, let <em>manifest</em> be the
result of parsing the bytes starting at offset <em>sections-start</em> +
<code>section-offsets</code>["manifest"] using the instructions in <a href="#manifest" class="xref">Section 2.4</a>.<a href="#section-2.2.2-10" class="pilcrow">¶</a></p>
<p id="section-2.2.2-11">The parser MAY return a semantic package consisting of <em>index</em>, and,
if initialized, <em>manifest</em>.<a href="#section-2.2.2-11" class="pilcrow">¶</a></p>
<p id="section-2.2.2-12">To parse each resource described within <em>index</em>, the parser MUST follow the
instructions in <a href="#resource" class="xref">Section 2.5</a>.<a href="#section-2.2.2-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="index">
<section id="section-2.3">
        <h3 id="name-parsing-the-index">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-parsing-the-index" class="section-name selfRef">Parsing the index</a>
        </h3>
<p id="section-2.3-1">The main content of a package is an index of HTTP requests pointing to HTTP
responses. These request/response pairs hold the manifests of sub-packages and
the resources in the package and all of its sub-packages. Both the requests and
responses can appear in any order, usually chosen to optimize loading while the
package is streamed.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">To parse the index, starting at offset <em>index-start</em>, the parser MUST do the
following:<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">If the byte at <em>index-start</em> is not 0x82 (the <span>[<a href="#CBOR" class="xref">CBOR</a>]</span> header for a 2-element
array), the parser MUST fail.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">Load a CBOR item starting at <em>index-start</em> + 1 as the <code>index</code> array in the following CDDL:<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cddl" id="section-2.3-5">
<pre>
index = [* [resource-key: http-headers,
            offset: uint,
            ? length: uint] ]

; http-headers is a byte string in HPACK format (RFC7541).
http-headers = bstr
</pre><a href="#section-2.3-5" class="pilcrow">¶</a>
</div>
<p id="section-2.3-6">If the item doesn't match this CDDL, or it is not a Canonical CBOR item (Section
3.9 of <span>[<a href="#CBOR" class="xref">CBOR</a>]</span>), the parser MUST fail.<a href="#section-2.3-6" class="pilcrow">¶</a></p>
<p id="section-2.3-7">Let <em>resources-start</em> be the offset immediately after the <code>index</code> item. For
example, if <em>index-start</em> were 75 and the <code>index</code> item were 105 bytes long,
<em>resources-start</em> would be 75+1+105=181. (1 for the 0x82 array header.)<a href="#section-2.3-7" class="pilcrow">¶</a></p>
<p id="section-2.3-8">Decode all of the <code>resource-key</code>s using <span>[<a href="#HPACK" class="xref">HPACK</a>]</span>, with an
initially-empty dynamic table for each one. 
  <span class="cref" id="ednote-compression">This spec has different security constraints from the
ones that drove HPACK, so we may be able to do better with another
compression format.<span class="crefSource">jyasskin</span></span> The decoded <code>resource-key</code>s are header lists
(<span>[<a href="#HPACK" class="xref">HPACK</a>]</span>, Section 1.3), ordered lists of name-value pairs.<a href="#section-2.3-8" class="pilcrow">¶</a></p>
<p id="section-2.3-9">The parser MUST fail if any of the following is true:<a href="#section-2.3-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-10">
          <li id="section-2.3-10.1">HPACK decoding encountered an error.<a href="#section-2.3-10.1" class="pilcrow">¶</a>
</li>
<li id="section-2.3-10.2">Any <code>resource-key</code>'s first three headers are not named ":scheme",
":authority", and ":path", in that order. Note that ":method" is
intentionally omitted because only the GET method is meaningful.<a href="#section-2.3-10.2" class="pilcrow">¶</a>
</li>
<li id="section-2.3-10.3">Any of the pseudo-headers' values violates a requirement in Section
8.1.2.3 of <span>[<a href="#HTTP2" class="xref">HTTP2</a>]</span>.<a href="#section-2.3-10.3" class="pilcrow">¶</a>
</li>
<li id="section-2.3-10.4">Any <code>resource-key</code> has a non-pseudo-header name that includes the
":" character or is not lower-case ascii (<span>[<a href="#HTTP2" class="xref">HTTP2</a>]</span>, Section
8.1.2).<a href="#section-2.3-10.4" class="pilcrow">¶</a>
</li>
<li id="section-2.3-10.5">Any two decoded <code>resource-key</code>s are the same. Note that header
lists with the same header fields in a different order are not the
same.<a href="#section-2.3-10.5" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-2.3-11">Increment all <code>offset</code>s by <em>resources-start</em>.<a href="#section-2.3-11" class="pilcrow">¶</a></p>
<p id="section-2.3-12">Return the resulting <code>index</code>, an array of decoded-resource-key, adjusted-offset,
and optional-length triples.<a href="#section-2.3-12" class="pilcrow">¶</a></p>
<p id="section-2.3-13">The optional <code>length</code> field in the index entries is redundant with the length
prefixes on the <code>response-headers</code> and <code>body</code> in the content, but it can be used
to issue Range requests <span>[<a href="#RFC7233" class="xref">RFC7233</a>]</span> for responses that appear late in the
content.<a href="#section-2.3-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="manifest">
<section id="section-2.4">
        <h3 id="name-parsing-the-manifest">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-parsing-the-manifest" class="section-name selfRef">Parsing the manifest</a>
        </h3>
<p id="section-2.4-1">A package's manifest contains some metadata for the package; hashes, used in
<a href="#hashing-resources" class="xref">Section 2.5, Paragraph 10</a>, for all resources included in that package; and
validity information for any <span><a href="#subpackages" class="xref">sub-packages</a> (<a href="#subpackages" class="xref">Section 2.4.1</a>)</span> the package depends
on. The manifest is signed, so that UAs can trust that it comes from its claimed
origin. 
  <span class="cref" id="ednote-manifest-name">This section doesn't describe a manifest
(https://www.merriam-webster.com/dictionary/manifest#h3), so consider
renaming it to something like "authenticity".<span class="crefSource">jyasskin</span></span><a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">To parse a manifest starting at <em>manifest-start</em>, a parser MUST do the following:<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">Load one CBOR item starting at <em>manifest-start</em> as a <code>signed-manifest</code> from the
following CDDL:<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cddl" id="section-2.4-4">
<pre>
signed-manifest = {
  manifest: manifest,
  certificates: [+ certificate],
  signatures: [+ signature]
}

manifest = {
  metadata: manifest-metadata,
  resource-hashes: {* hash-algorithm =&gt; [hash-value]},
  ? subpackages: [* subpackage],
}

manifest-metadata = {
  date: time,
  origin: uri,
  * tstr =&gt; any,
}

; From https://www.w3.org/TR/CSP3/#grammardef-hash-algorithm.
hash-algorithm /= "sha256" / "sha384" / "sha512"
; Note that a hash value is not base64-encoded, unlike in CSP.
hash-value = bstr

; X.509 format; see https://tools.ietf.org/html/rfc5280
certificate = bstr

signature = {
  ; This is the index of the certificate within the
  ; certificates array to use to validate the signature.
  keyIndex: uint,
  signature: bstr,
}
</pre><a href="#section-2.4-4" class="pilcrow">¶</a>
</div>
<p id="section-2.4-5">If the item doesn't match the CDDL or it's not a Canonical CBOR item (Section
3.9 of <span>[<a href="#CBOR" class="xref">CBOR</a>]</span>), parsing MUST fail.<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<p id="section-2.4-6">Parse the elements of <code>certificates</code> as X.509 certificates within the
<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> profile. If any certificate fails to parse, parsing MUST fail.<a href="#section-2.4-6" class="pilcrow">¶</a></p>
<p id="section-2.4-7">Let <em>message</em> be the concatenation of the following byte strings. This matches
the <span>[<a href="#TLS1.3" class="xref">TLS1.3</a>]</span> format to avoid cross-protocol attacks when
TLS certificates are used to sign manifests.<a href="#section-2.4-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.4-8">
          <li id="section-2.4-8.1">A string that consists of octet 32 (0x20) repeated 64 times.<a href="#section-2.4-8.1" class="pilcrow">¶</a>
</li>
<li id="section-2.4-8.2">A context string: the ASCII encoding of "Web Package Manifest".<a href="#section-2.4-8.2" class="pilcrow">¶</a>
</li>
<li id="section-2.4-8.3">A single 0 byte which serves as a separator.<a href="#section-2.4-8.3" class="pilcrow">¶</a>
</li>
<li id="section-2.4-8.4">The bytes of the <code>manifest</code> CBOR item.<a href="#section-2.4-8.4" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-2.4-9">Let <em>signing-certificates</em> be an empty array.<a href="#section-2.4-9" class="pilcrow">¶</a></p>
<p id="section-2.4-10">For each element <em>signature</em> of <code>signatures</code>:<a href="#section-2.4-10" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.4-11">
          <li id="section-2.4-11.1">Let <em>certificate</em> be <code>certificates</code>[<em>signature</em>["keyIndex"]].<a href="#section-2.4-11.1" class="pilcrow">¶</a>
</li>
<li id="section-2.4-11.2">
            <p id="section-2.4-11.2.1">The parser MUST define a partial function from public key types to signing
algorithms, and this function must at the minimum include the following
mappings:<a href="#section-2.4-11.2.1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-2.4-11.2.2">
              <dt id="section-2.4-11.2.2.1">RSA, 2048 bits:</dt>
<dd id="section-2.4-11.2.2.2">
      rsa_pss_sha256 as defined in Section 4.2.3 of <span>[<a href="#TLS1.3" class="xref">TLS1.3</a>]</span><a href="#section-2.4-11.2.2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-2.4-11.2.2.3">EC, with the secp256r1 curve:</dt>
<dd id="section-2.4-11.2.2.4">
      ecdsa_secp256r1_sha256 as defined in Section 4.2.3 of <span>[<a href="#TLS1.3" class="xref">TLS1.3</a>]</span><a href="#section-2.4-11.2.2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-2.4-11.2.2.5">EC, with the secp384r1 curve:</dt>
<dd id="section-2.4-11.2.2.6">
      ecdsa_secp384r1_sha384 as defined in Section 4.2.3 of <span>[<a href="#TLS1.3" class="xref">TLS1.3</a>]</span><a href="#section-2.4-11.2.2.6" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-2.4-11.2.3">
Let <em>signing-alg</em> be the result of applying this function to the key type in
<em>certificate</em>'s Subject Public Key Info. If the function is undefined on this
input, the parser MUST continue to the next <em>signature</em>.<a href="#section-2.4-11.2.3" class="pilcrow">¶</a></p>
</li>
<li id="section-2.4-11.3">Use <em>signing-alg</em> to verify that <em>signature</em>["signature"] is <em>message</em>'s
signature by <em>certificate</em>'s public key. If it's not, the parser MUST
continue to the next <em>signature</em>.<a href="#section-2.4-11.3" class="pilcrow">¶</a>
</li>
<li id="section-2.4-11.4">Append <em>certificate</em> to <em>signing-certificates</em>. Note that failed signatures
simply cause their certificate to be ignored, so that packagers can give new
signature types to parsers that understand them.<a href="#section-2.4-11.4" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-2.4-12">Let <em>origin</em> be <code>manifest</code>["metadata"]["origin"].<a href="#section-2.4-12" class="pilcrow">¶</a></p>
<p id="section-2.4-13">Iterate through <em>signing-certificates</em> until one is found that has an identity
(<span>[<a href="#RFC2818" class="xref">RFC2818</a>]</span>, Section 3.1) matching <em>origin</em>'s hostname, and that is trusted
for serverAuth (<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>, Section 4.2.1.12) using paths built from elements
of <code>certificates</code> or any other certificates the parser is aware of. If no such
certificate is found, and the package is not already trusted as received from
<em>origin</em>'s hostname, for example because it was received over a TLS connection
to that host, then parsing MUST fail.<a href="#section-2.4-13" class="pilcrow">¶</a></p>
<p id="section-2.4-14"><strong>TODO:</strong> Process the <code>subpackages</code> item by fetching those manifests via the index,
and checking their signatures and dates/hashes, recursively.<a href="#section-2.4-14" class="pilcrow">¶</a></p>
<p id="section-2.4-15">The parsed manifest consists of the set of <em>signing-certificates</em> and the
<code>manifest</code> CBOR item. The items in <code>manifest</code>["metadata"] SHOULD be interpreted
as described in the <span>[<a href="#appmanifest" class="xref">appmanifest</a>]</span> specification.<a href="#section-2.4-15" class="pilcrow">¶</a></p>
<div id="subpackages">
<section id="section-2.4.1">
          <h4 id="name-sub-packages">
<a href="#section-2.4.1" class="section-number selfRef">2.4.1. </a><a href="#name-sub-packages" class="section-name selfRef">Sub-packages</a>
          </h4>
<p id="section-2.4.1-1">A sub-package is represented by a <a href="#manifest" class="xref">Section 2.4</a> file looked up as
a <a href="#resource" class="xref">Section 2.5</a> within the <code>indexed-content</code> section. The sub-package's
resources are not otherwise distinguished from the rest of the resources in the
package. Sub-packages can form an arbitrarily-deep tree.<a href="#section-2.4.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cddl" id="section-2.4.1-2">
<pre>
subpackage = [
  resource: resource-key,
  validation: {
    ? hash: {+ hash-algorithm =&gt; hash-value},
    ? notbefore: time,
  }
]
</pre><a href="#section-2.4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.4.1-3">There are three possible forms of dependencies on sub-packages, of which we
allow two. Because a sub-package's manifest is protected by its own signature,
if the main package trusts the sub-package's server, it could avoid specifying a
version of the sub-package at all. However, this opens the main package up to
downgrade attacks, where the sub-package is replaced by an older, vulnerable
version, so we don't allow this option.<a href="#section-2.4.1-3" class="pilcrow">¶</a></p>
<p id="section-2.4.1-4">If the main package wants to load either the sub-package it was built with or
any upgrade, it can specify the date of the original sub-package:<a href="#section-2.4.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cbor-diag" id="section-2.4.1-5">
<pre>
[32("https://example.com/loginsdk.package"),
 {"notbefore": 1(1486429554)}]
</pre><a href="#section-2.4.1-5" class="pilcrow">¶</a>
</div>
<p id="section-2.4.1-6">Constraining packages with their date makes it possible to link together
sub-packages with common dependencies, even if the sub-packages were built at
different times.<a href="#section-2.4.1-6" class="pilcrow">¶</a></p>
<p id="section-2.4.1-7">If the main package wants to be certain it's loading the exact version
of a sub-package that it was built with, it can constrain the sub-package
with a hash of its manifest:<a href="#section-2.4.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cbor-diag" id="section-2.4.1-8">
<pre>
[32("https://example.com/loginsdk.package"),
 {"hash": {"sha256":
     b64'9qg0NGDuhsjeGwrcbaxMKZAvfzAHJ2d8L7NkDzXhgHk='}}]
</pre><a href="#section-2.4.1-8" class="pilcrow">¶</a>
</div>
<p id="section-2.4.1-9">Note that because the sub-package may include sub-sub-packages by date, the top
package may need to explicitly list those sub-sub-packages' hashes in order to
be completely constrained. For example, if <code>loginsdk.package</code> has subpackages
of the form:<a href="#section-2.4.1-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cbor-diag" id="section-2.4.1-10">
<pre>
[
  [32("https://other.example.com/helper.package"),
   {"notbefore": 1(1486429554)}]
]
</pre><a href="#section-2.4.1-10" class="pilcrow">¶</a>
</div>
<p id="section-2.4.1-11">the top-level package needs to specify:<a href="#section-2.4.1-11" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cbor-diag" id="section-2.4.1-12">
<pre>
[
  [32("https://example.com/loginsdk.package"),
   {"hash": {"sha256":
        b64'9qg0NGDuhsjeGwrcbaxMKZAvfzAHJ2d8L7NkDzXhgHk='}}],
  [32("https://other.example.com/helper.package"),
   {"hash": {"sha256":
        b64'SG2GjbrpfVCh21HPLMIXD17fHNCst1Gz/MbQOqihG68='}}]
]
</pre><a href="#section-2.4.1-12" class="pilcrow">¶</a>
</div>
<p id="section-2.4.1-13">in order to completely constrain all the versions of its dependencies.<a href="#section-2.4.1-13" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="resource">
<section id="section-2.5">
        <h3 id="name-parsing-a-resource">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-parsing-a-resource" class="section-name selfRef">Parsing a resource</a>
        </h3>
<p id="section-2.5-1">To parse the resource from a <em>package</em> corresponding to a <em>header-list</em>, a
parser MUST do the following:<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">Find the (<em>resource-key</em>, <em>offset</em>, <em>length</em>) triple in <em>package</em>'s index where
<em>resource-key</em> is the same as <em>header-list</em>. If no such triple exists, the
parser MUST fail.<a href="#section-2.5-2" class="pilcrow">¶</a></p>
<p id="section-2.5-3">Parse one CBOR item starting at <em>offset</em> as the following CDDL:<a href="#section-2.5-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cddl" id="section-2.5-4">
<pre>
response = [response-headers: http-headers, body: bstr]
</pre><a href="#section-2.5-4" class="pilcrow">¶</a>
</div>
<p id="section-2.5-5">If the item doesn't match the CDDL or it's not a Canonical CBOR item (Section
3.9 of <span>[<a href="#CBOR" class="xref">CBOR</a>]</span>), parsing MUST fail.<a href="#section-2.5-5" class="pilcrow">¶</a></p>
<p id="section-2.5-6">Decode the <code>response-headers</code> field using <span>[<a href="#HPACK" class="xref">HPACK</a>]</span>, with an
initially-empty dynamic table. The decoded <code>response-headers</code> is a
header list (<span>[<a href="#HPACK" class="xref">HPACK</a>]</span>, Section 1.3), an ordered list of name-value
pairs.<a href="#section-2.5-6" class="pilcrow">¶</a></p>
<p id="section-2.5-7">The parser MUST fail if any of the following is true:<a href="#section-2.5-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.5-8">
          <li id="section-2.5-8.1">HPACK decoding encountered an error.<a href="#section-2.5-8.1" class="pilcrow">¶</a>
</li>
<li id="section-2.5-8.2">The first header name within <code>response-headers</code> is not ":status",
or this pseudo-header's value violates a requirement in Section
8.1.2.3 of <span>[<a href="#HTTP2" class="xref">HTTP2</a>]</span>.<a href="#section-2.5-8.2" class="pilcrow">¶</a>
</li>
<li id="section-2.5-8.3">Any other header name includes the ":" character or is not
lower-case ascii (<span>[<a href="#HTTP2" class="xref">HTTP2</a>]</span>, Section 8.1.2).<a href="#section-2.5-8.3" class="pilcrow">¶</a>
</li>
<li id="section-2.5-8.4">The <em>header-list</em> contains any header names other than ":scheme",
":authority", ":path", and either <code>response-headers</code> has no "vary"
header (Section 7.1.4 of <span>[<a href="#RFC7231" class="xref">RFC7231</a>]</span>) or these header names aren't
listed in it.<a href="#section-2.5-8.4" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-2.5-9">Let <em>origin</em> be the Web Origin <span>[<a href="#RFC6454" class="xref">RFC6454</a>]</span> of <em>header-list</em>'s ":scheme" and
":authority" headers.<a href="#section-2.5-9" class="pilcrow">¶</a></p>
<div id="hashing-resources">
<p id="section-2.5-10">Let <em>resource-bytes</em> be the result of encoding the array of
[<em>header-list</em>, <code>response-headers</code>, <code>body</code>] as Canonical CBOR in the
following CDDL schema: 
  <span class="cref" id="ednote-figure-in-list">This step would be inside the manifest-only block, but
then the code block is rendered out-of-order.<span class="crefSource">jyasskin</span></span><a href="#section-2.5-10" class="pilcrow">¶</a></p>
</div>
<div class="artwork art-text alignLeft art-cddl" id="section-2.5-11">
<pre>
resource-bytes = [
  request: [
    *(header-name: bstr, header-value: bstr)
  ],
  response-headers: [
    *(header-name: bstr, header-value: bstr)
  ],
  response-body: bstr
]
</pre><a href="#section-2.5-11" class="pilcrow">¶</a>
</div>
<p id="section-2.5-12">Note that this uses the decoded header fields, not the bytes originally included
in the package.<a href="#section-2.5-12" class="pilcrow">¶</a></p>
<p id="section-2.5-13">The hashed data differs from <span>[<a href="#SRI" class="xref">SRI</a>]</span>, which only hashes the body. Including the
headers will usually prevent a package from relying on some of its contents
being transferred as normal network responses, unless its author can guarantee
the network won't change or reorder the headers.<a href="#section-2.5-13" class="pilcrow">¶</a></p>
<p id="section-2.5-14">If the <em>package</em> contains a <em>manifest</em>:<a href="#section-2.5-14" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.5-15">
          <li id="section-2.5-15.1">
            <strong>TODO:</strong> Let <em>origin-manifest</em> be the signed manifest for <em>origin</em>, found
by searching through <em>manifest</em>'s subpackages for a matching origin.<a href="#section-2.5-15.1" class="pilcrow">¶</a>
</li>
<li id="section-2.5-15.2">Let <em>alg</em> be one of the <code>hash-algorithm</code>s within <em>origin-manifest</em>. The
parser SHOULD select the most collision-resistant hash algorithm. If the
parser also implements <span>[<a href="#SRI" class="xref">SRI</a>]</span>, it SHOULD use the same order as its
<code>getPrioritizedHashFunction()</code> implementation.<a href="#section-2.5-15.2" class="pilcrow">¶</a>
</li>
<li id="section-2.5-15.3">If the digest of <em>resource-bytes</em> using <em>alg</em> does not appear in the
<em>origin-manifest</em>'s <code>resource-hashes</code>[<em>alg</em>] array, the parser MUST fail.<a href="#section-2.5-15.3" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-2.5-16">Return the (decoded <code>response-headers</code>, <code>body</code>) pair.<a href="#section-2.5-16" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authoring-guidelines">
<section id="section-3">
      <h2 id="name-guidelines-for-package-auth">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-guidelines-for-package-auth" class="section-name selfRef">Guidelines for package authors</a>
      </h2>
<p id="section-3-1">Packages SHOULD consist of a single Canonical CBOR item matching the
<code>webpackage</code> CDDL rule in <a href="#top-level" class="xref">Section 2.2</a>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Every resource's hash SHOULD appear in every array within
<code>resource-hashes</code>: otherwise the set of valid resources will depend on
the parser's choice of preferred hash algorithm.<a href="#section-3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">Signature validation is difficult.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Packages with a valid signature need to be invalidated when either<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-3.1">the private key for any certificate in the signature's validation
chain is leaked, or<a href="#section-4-3.1" class="pilcrow">¶</a>
</li>
<li id="section-4-3.2">a vulnerability is discovered in the package's contents.<a href="#section-4-3.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4-4">Because packages are intended to be used offline, it's impossible to
inject a revocation check into the critical path of using the package,
and even in online scenarios,
such
<a href="https://www.imperialviolet.org/2012/02/05/crlsets.html">revocation checks don't actually work</a>.
Instead, package consumers must check for a sufficiently recent set of
validation files, consisting of OCSP responses <span>[<a href="#RFC6960" class="xref">RFC6960</a>]</span> and signed
package version constraints, for example within the last 7-30 days.
<strong>TODO:</strong> These version constraints aren't designed yet.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Relaxing the requirement to consult DNS when determining authority for an origin
means that an attacker who possesses a valid certificate no longer needs to be
on-path to redirect traffic to them; instead of modifying DNS, they need only
convince the user to visit another Web site, in order to serve packages signed
as the target.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">All subpackages that mention a particular origin need to be validated
before loading resources from that origin. Otherwise, package A could
include package B and an old, vulnerable version of package C that B
also depends on. If B's dependency isn't checked before loading
resources from C, A could compromise B.<a href="#section-4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA considerations</a>
      </h2>
<div id="internet-media-type-registration">
<section id="section-5.1">
        <h3 id="name-internet-media-type-registr">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-internet-media-type-registr" class="section-name selfRef">Internet Media Type Registration</a>
        </h3>
<p id="section-5.1-1">IANA maintains the registry of Internet Media Types <span>[<a href="#RFC6838" class="xref">RFC6838</a>]</span>
at <a href="https://www.iana.org/assignments/media-types">https://www.iana.org/assignments/media-types</a>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.1-2.1">Type name: application<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.2">Subtype name: package+cbor 
      <span class="cref" id="ednote-mime-naming">I suspect the mime type will need to be a bit longer:
application/webpackage+cbor or similar.<span class="crefSource">jyasskin</span></span><a href="#section-5.1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.3">Required parameters: N/A<a href="#section-5.1-2.3" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.4">Optional parameters: N/A<a href="#section-5.1-2.4" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.5">Encoding considerations: binary<a href="#section-5.1-2.5" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.6">Security considerations: See <a href="#security" class="xref">Section 4</a> of this document.<a href="#section-5.1-2.6" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.7">Interoperability considerations: N/A<a href="#section-5.1-2.7" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.8">Published specification: This document<a href="#section-5.1-2.8" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.9">Applications that use this media type: None yet, but it is expected that web
   browsers will use this format.<a href="#section-5.1-2.9" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.10">Fragment identifier considerations: N/A<a href="#section-5.1-2.10" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.11">
            <p id="section-5.1-2.11.1">Additional information:<a href="#section-5.1-2.11.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.1-2.11.2.1">Deprecated alias names for this type: N/A<a href="#section-5.1-2.11.2.1" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.11.2.2">Magic number(s): 85 48 F0 9F 8C 90 F0 9F 93 A6<a href="#section-5.1-2.11.2.2" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.11.2.3">File extension(s): .wpk<a href="#section-5.1-2.11.2.3" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.11.2.4">Macintosh file type code(s): N/A<a href="#section-5.1-2.11.2.4" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-5.1-2.12">Person &amp; email address to contact for further information:
See the Author's Address section of this specification.<a href="#section-5.1-2.12" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.13">Intended usage: COMMON<a href="#section-5.1-2.13" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.14">Restrictions on usage: N/A<a href="#section-5.1-2.14" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.15">Author:
See the Author's Address section of this specification.<a href="#section-5.1-2.15" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.16">Change controller:
The IESG <a href="mailto:iesg@ietf.org">iesg@ietf.org</a><a href="#section-5.1-2.16" class="pilcrow">¶</a>
</li>
<li id="section-5.1-2.17">Provisional registration? (standards tree only): Not yet.<a href="#section-5.1-2.17" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<section id="section-6">
      <h2 id="name-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-normative-references">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="appmanifest">[appmanifest]</dt>
<dd>
<span class="refAuthor">Caceres, M.</span><span class="refAuthor">, Christiansen, K.</span><span class="refAuthor">, Lamouri, M.</span><span class="refAuthor">, and A. Kostiainen</span>, <span class="refTitle">"Web App Manifest"</span>, <span class="seriesInfo">World Wide Web Consortium WD WD-appmanifest-20170608</span>, <time datetime="2017-06-08">8 June 2017</time>, <span>&lt;<a href="https://www.w3.org/TR/2017/WD-appmanifest-20170608">https://www.w3.org/TR/2017/WD-appmanifest-20170608</a>&gt;</span>. </dd>
<dt id="CBOR">[CBOR]</dt>
<dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor"> and P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7049">https://www.rfc-editor.org/info/rfc7049</a>&gt;</span>. </dd>
<dt id="CDDL">[CDDL]</dt>
<dd>
<span class="refAuthor">Birkholz, H.</span><span class="refAuthor">, Vigano, C.</span><span class="refAuthor">, and C. Bormann</span>, <span class="refTitle">"Concise data definition language (CDDL): a notational convention to express CBOR data structures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-greevenbosch-appsawg-cbor-cddl-11</span>, <time datetime="2017-07-03">3 July 2017</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-greevenbosch-appsawg-cbor-cddl-11.txt">http://www.ietf.org/internet-drafts/draft-greevenbosch-appsawg-cbor-cddl-11.txt</a>&gt;</span>. </dd>
<dt id="HPACK">[HPACK]</dt>
<dd>
<span class="refAuthor">Peon, R.</span><span class="refAuthor"> and H. Ruellan</span>, <span class="refTitle">"HPACK: Header Compression for HTTP/2"</span>, <span class="seriesInfo">RFC 7541</span>, <span class="seriesInfo">DOI 10.17487/RFC7541</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7541">https://www.rfc-editor.org/info/rfc7541</a>&gt;</span>. </dd>
<dt id="HTTP2">[HTTP2]</dt>
<dd>
<span class="refAuthor">Belshe, M.</span><span class="refAuthor">, Peon, R.</span><span class="refAuthor">, and M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC2818">[RFC2818]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"HTTP Over TLS"</span>, <span class="seriesInfo">RFC 2818</span>, <span class="seriesInfo">DOI 10.17487/RFC2818</span>, <time datetime="2000-05">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2818">https://www.rfc-editor.org/info/rfc2818</a>&gt;</span>. </dd>
<dt id="RFC5280">[RFC5280]</dt>
<dd>
<span class="refAuthor">Cooper, D.</span><span class="refAuthor">, Santesson, S.</span><span class="refAuthor">, Farrell, S.</span><span class="refAuthor">, Boeyen, S.</span><span class="refAuthor">, Housley, R.</span><span class="refAuthor">, and W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dt id="RFC6454">[RFC6454]</dt>
<dd>
<span class="refAuthor">Barth, A.</span>, <span class="refTitle">"The Web Origin Concept"</span>, <span class="seriesInfo">RFC 6454</span>, <span class="seriesInfo">DOI 10.17487/RFC6454</span>, <time datetime="2011-12">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6454">https://www.rfc-editor.org/info/rfc6454</a>&gt;</span>. </dd>
<dt id="RFC6960">[RFC6960]</dt>
<dd>
<span class="refAuthor">Santesson, S.</span><span class="refAuthor">, Myers, M.</span><span class="refAuthor">, Ankney, R.</span><span class="refAuthor">, Malpani, A.</span><span class="refAuthor">, Galperin, S.</span><span class="refAuthor">, and C. Adams</span>, <span class="refTitle">"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"</span>, <span class="seriesInfo">RFC 6960</span>, <span class="seriesInfo">DOI 10.17487/RFC6960</span>, <time datetime="2013-06">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6960">https://www.rfc-editor.org/info/rfc6960</a>&gt;</span>. </dd>
<dt id="RFC7231">[RFC7231]</dt>
<dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor"> and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"</span>, <span class="seriesInfo">RFC 7231</span>, <span class="seriesInfo">DOI 10.17487/RFC7231</span>, <time datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="SRI">[SRI]</dt>
<dd>
<span class="refAuthor">Akhawe, D.</span><span class="refAuthor">, Braun, F.</span><span class="refAuthor">, Marier, F.</span><span class="refAuthor">, and J. Weinberger</span>, <span class="refTitle">"Subresource Integrity"</span>, <span class="seriesInfo">World Wide Web Consortium Recommendation REC-SRI-20160623</span>, <time datetime="2016-06-23">23 June 2016</time>, <span>&lt;<a href="http://www.w3.org/TR/2016/REC-SRI-20160623">http://www.w3.org/TR/2016/REC-SRI-20160623</a>&gt;</span>. </dd>
<dt id="TLS1.3">[TLS1.3]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-tls13-28</span>, <time datetime="2018-03-20">20 March 2018</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-tls13-28.txt">http://www.ietf.org/internet-drafts/draft-ietf-tls-tls13-28.txt</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-informative-references">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.yasskin-wpack-use-cases">[I-D.yasskin-wpack-use-cases]</dt>
<dd>
<span class="refAuthor">Yasskin, J.</span>, <span class="refTitle">"Use Cases and Requirements for Web Packages"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-yasskin-wpack-use-cases-00</span>, <time datetime="2019-10-30">30 October 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-yasskin-wpack-use-cases-00.txt">http://www.ietf.org/internet-drafts/draft-yasskin-wpack-use-cases-00.txt</a>&gt;</span>. </dd>
<dt id="RFC6838">[RFC6838]</dt>
<dd>
<span class="refAuthor">Freed, N.</span><span class="refAuthor">, Klensin, J.</span><span class="refAuthor">, and T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;</span>. </dd>
<dt id="RFC7233">[RFC7233]</dt>
<dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor">, Lafon, Y., Ed.</span><span class="refAuthor">, and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Range Requests"</span>, <span class="seriesInfo">RFC 7233</span>, <span class="seriesInfo">DOI 10.17487/RFC7233</span>, <time datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7233">https://www.rfc-editor.org/info/rfc7233</a>&gt;</span>. </dd>
<dt id="ServiceWorkers">[ServiceWorkers]</dt>
<dd>
<span class="refAuthor">Russell, A.</span><span class="refAuthor">, Song, J.</span><span class="refAuthor">, Archibald, J.</span><span class="refAuthor">, and M. Kruisselbrink</span>, <span class="refTitle">"Service Workers 1"</span>, <span class="seriesInfo">World Wide Web Consortium WD WD-service-workers-1-20161011</span>, <time datetime="2016-10-11">11 October 2016</time>, <span>&lt;<a href="https://www.w3.org/TR/2016/WD-service-workers-1-20161011">https://www.w3.org/TR/2016/WD-service-workers-1-20161011</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="section-appendix.a">
      <h2 id="name-acknowledgements">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.a-1">Thanks to Adam Langley and Ryan Sleevi for in-depth feedback about the security
impact of this proposal.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jeffrey Yasskin</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jyasskin@chromium.org" class="email">jyasskin@chromium.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
